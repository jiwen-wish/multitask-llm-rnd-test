# Product title taxonomy classification through conditional language modelling

## [v0.4](version_4)
- Trained trained on {input: “iphone”, output: “phone > apple”} as well as {input: “iphone”, output_reverse: “apple < phone”} with different task prompts
- Use [Aliexpress data](../../datasets/product_title_taxonomy_classification/wish-aliexpress.yaml) only
- To reproduce run below from `query_understanding_model` directory on 7 x V100-16GB instance within [Docker dev Container](../../.devcontainer/devcontainer.json)

`python main_conditional_lm.py fit --config models/product_title_taxonomy_classification/version_4/config.yaml`

## [v0.5](version_5)
- Initialize with weights of [v0.4](version_4), train on similar formatted data as [v0.4](version_4)
- Use [v0.1 openai data](../../datasets/product_title_taxonomy_classification/wish-tahoe-openai.yaml) 
    - [v0.1 openai data](../../datasets/product_title_taxonomy_classification/wish-tahoe-openai.yaml) is generated by using [Mturk test set](https://github.com/junwang-wish/query_understanding_data/blob/main/data/wish_products/wish-mturk-labelled-09202022.xlsx.dvc) as few-shot prompts to pseudolabel [Wish product titles in Tahoe](https://github.com/junwang-wish/query_understanding_data/blob/main/data/wish_products_truetag_tahoe/download_wish_truetag_tahoe_data.py) with [this script](https://github.com/junwang-wish/query_understanding_data/blob/main/notebooks/openai/few_shot_taxonomize_wish_tahoe.py) based on GPT3
    - However, [v0.1 openai data](../../datasets/product_title_taxonomy_classification/wish-tahoe-openai.yaml) potnetially data-leaks [Mturk test set](https://github.com/junwang-wish/query_understanding_data/blob/main/data/wish_products/wish-mturk-labelled-09202022.xlsx.dvc) since it was generated by using the test set as prompts
    - This is expected, since [v0.5](version_5) is intended to test the effectiveness of utilizing GPT3 as a psudolabeller to generate arbitrary training data
- To reproduce run below from `query_understanding_model` directory on 7 x V100-16GB instance within [Docker dev Container](../../.devcontainer/devcontainer.json)

`python main_conditional_lm.py fit --config models/product_title_taxonomy_classification/version_5/config.yaml`